apiVersion: v1
kind: ConfigMap
metadata:
  name: skaha-config
  namespace: {{ .Values.skaha.namespace }}
data:
{{ tpl (.Files.Glob "config/*").AsConfig . | indent 2 }}
{{ $currentScope := .}}
{{- range $path, $_ := (.Files.Glob "skaha-config/*") }}
{{- with $currentScope}}
{{ $path }}: |
{{- if (hasSuffix ".yaml" $path) }}
  {{- tpl (.Files.Get $path) . | nindent 2 }}
{{- else }}
  {{- .Files.Get $path | nindent 2 }}
{{- end }}
{{- end }}
{{- end }}
